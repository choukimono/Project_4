\documentclass[a4paper, twoside, 11pt]{report}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage[top= 120pt, left=80pt, right=80pt]{geometry} %marges
\usepackage{setspace} %interlignage
\usepackage{url}
\usepackage{graphicx}
\usepackage{lmodern} 
\usepackage{array}
\usepackage{csquotes}
\usepackage[numbers,square]{natbib}
\usepackage{soul}
\usepackage{hyperref}
\usepackage{amsthm}
\usepackage{color}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{adjustbox}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{dsfont}
%%\usepackage{braket}
\usepackage{physics}
\usepackage{amsfonts}
\usepackage[numbers,square]{natbib}
\usepackage{multirow}
\usepackage{listings}
\usepackage{wasysym}
\usepackage{algpseudocode}
\usepackage[ruled]{algorithm2e}
\usepackage{caption}


%%%%%% COULEURS CODE C++
\lstdefinestyle{customc}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=L,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{red},
  commentstyle=\itshape\color{gray},
  identifierstyle=\color{NavyBlue},
  stringstyle=\color{black},
}

\lstdefinestyle{customasm}{
  belowcaptionskip=1\baselineskip,
  frame=L,
  xleftmargin=\parindent,
  language=[x86masm]Assembler,
  basicstyle=\footnotesize\ttfamily,
  commentstyle=\itshape\color{purple!40!black},
}

\lstset{escapechar=@,style=customc}

%%%%%% STYLES DE THÉORÈMES

\newtheoremstyle{theorem}%	Name
  {}%	Space above
  {}%	Space below
  {}%	Body font
  {}%	Indent amount
  {\bfseries}%	Theorem head font
  {.}%	Punctuation after theorem head
  { }%	Space after theorem head, ' ', or \newline
  {}%	Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{exemple}%	Name
  {}%	Space above
  {}%	Space below
  {\color{Gray}\itshape}%	Body font
  {}%	Indent amount
  {\color{Gray}\itshape}%	Theorem head font
  {.}%	Punctuation after theorem head
  { }%	Space after theorem head, ' ', or \newline
  {}%	Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{remark}%	Name
  {}%	Space above
  {}%	Space below
  {\itshape}%	Body font
  {}%	Indent amount
  {\bfseries}%	Theorem head font
  {.}%	Punctuation after theorem head
  { }%	Space after theorem head, ' ', or \newline
  {}%	Theorem head spec (can be left empty, meaning `normal')
  
%%%%%% DÉCLARATION DES THÉORÈMES

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemme}{Lemma}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{definition}{Definition}[section]

\theoremstyle{remark}
\newtheorem{remark}{Remark}[chapter]

\theoremstyle{exemple}
\newtheorem*{exemple}{Example}


%%%%%% COMMANDES QUI SIMPLIFIENT LA VIE

\newcommand{\legende}[1]{
\begin{center}
	\begin{minipage}{12cm}
		\begin{center}
			\textit{\textcolor{WildStrawberry!30}{#1}}
		\end{center}
	\end{minipage}
\end{center}}

\newcommand{\sherlock}[2]{
	\begin{equation}
		\textcolor{WildStrawberry}{#1}
	\end{equation}
	\legende{#2}
}
	
\newcommand{\sherlocked}[1]{
	\begin{equation}
		\textcolor{WildStrawberry}{#1}
	\end{equation}
}

	
\newcommand{\defSherlock}[3]{
	\begin{definition}[\textbf{#1}]
		\sherlock{#2}{#3}
	\end{definition}
}

\newcommand{\defSherlocked}[2]{
	\begin{definition}[\textbf{#1}]
		\sherlocked{#2}
	\end{definition}
}	

\newcommand{\propSherlock}[3]{
	\begin{proposition}[\textbf{#1}]
		\sherlock{#2}{#3}
	\end{proposition}
}

\newcommand{\propSherlocked}[2]{
	\begin{proposition}[\textbf{#1}]
		\sherlocked{#2}
	\end{proposition}
}

\newcommand{\textSherlocked}[1]{
	\begin{center}
		\textcolor{WildStrawberry}{#1}
	\end{center}
}

\newcommand{\mimi}{\mathrm{Je\ t'aime}}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{FYS3150\\Project 4 - }
\author{Ethel Villeneuve}
\date{October 2017 \\University of Oslo \\ \url{https://github.com/choukimono/Project_4.git}}



\begin{document}
\selectlanguage{english}
\maketitle
	
	
\begin{abstract}
    
    \paragraph{}In this project, we want to implement the Ising model, in the case of a two-dimensional squared lattice, with periodic boundary conditions. In this lattice, we have $L\times L$ particles characterized by their spin (up or down). The starting point of the program will be a random lattice or a lattice with all the spins-up. The Metropolis algorithm will be run in a lattice $20\times20$ and then bigger. We will study the properties of the system : the mean energy $E$, the mean magnetization $|M|$, the specific heat and the susceptibility $\chi$ as function of the temperature. The purpose is then to study the phase transitions. We will again study these properties near the critical temperature (Curie point).
    
    \paragraph{}Quelques résultats...
    
\end{abstract}


\tableofcontents


\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}

    \paragraph{}
    

\chapter{Theory}
    
    \section{The Ising model}
    
        \subsection{The general model}
        
            \paragraph{}The Ising model is a mathematical model used in statistical mechanics. It consists of discrete variables, which represent the magnetic moment of the spin, which can take only two values (here $+1$ or $-1$). The spins will only interact with their direct neighbors. With this model, we can study the phase transitions at finite temperature for magnetic systems. We can expressed the energy as 
                
                \begin{equation*}
                    E = -J \sum\limits_{\langle  kl\rangle}^{N}s_ks_l - B \sum\limits_{k}^{N}s_k
                    \tag{1}
                \end{equation*}
            %Mets pas de saut de ligne ici patate, ça évitera l'alinéa moche.
            with $J$ a constant expressing the strength of the interaction between the neighboring spins, $\langle kl \rangle$ indicating the fact that we only sum the nearest neighbors, $N$ the number of spins, $s_{k,l} = \pm 1$ and $B$ an external magnetic field interacting with the magnetic moment set up by the spins. \\
            
            This is the general expression of the Ising model. For our use, we will only focus on the case where $B=0$. \\
            Then, we will be able to calculate expectation values of the mean energy $\langle E \rangle$ and magnetization $\langle M \rangle$ at a given temperature. To do this, we will use a Boltzmann distribution
            
                \begin{equation*}
                    P_i(\beta) = \frac{e^{-\beta E_i}}{Z}
                    \tag{2}
                \end{equation*}
             %blblbl
            where $P_i$ is the probability of finding the system in the state $i$, $\beta = \frac{1}{kT}$, $T$ being the temperature and $k$ the Boltzmann constant, $E_i$ is the energy of a state $i$ and $Z$ is the partition function defined by $\displaystyle Z = \sum\limits_{i=1}^{M}e^{-\beta E_i}$ with $M$ the number of configurations. $E_i$, which is the energy in the state $i$, is given by 
            
                \begin{equation*}
                    E_i = -J \sum\limits_{\langle kl \rangle}^{N}s_ks_l 
                    \tag{3}
                \end{equation*}
            with $k,l$ the different spins of the state $i$.\\  
            A simple particular case of the Ising model, the two-dimensional square lattice model, allows us to have an analytical solution. 
        
        \subsection{Two-dimensional square lattice model}
        
            \paragraph{}This particular case is one of the simplest models to show a phase transition. It is defined by conditions : the external magnetic field $B=0$, this is a two-dimensional lattice with N sites, with periodic boundary conditions. Let's take the case with $N=2\times2$ spins. We have $2^4 = 16$ different states with those conditions. We reuse the equation (3) to find the energy of each configuration with the spins-up taking the value $+1$ and the spins-down taking the value $-1$. Let's take for example the case where three spins are pointing up (and so one is pointing down) numbered from 1 to 4 :
                $\begin{matrix}
                    \downarrow ^{(1)} & \uparrow ^{(2)}\\
                    \uparrow ^{(3)} & \uparrow ^{(4)}
                \end{matrix}$.
            %    
                \begin{align*}
                    E &= -J \sum\limits_{\langle kl \rangle}^{4}s_ks_l \\
                      &= -J (s_1s_2 + s_2s_1 + s_1s_3 + s_3s_1 + s_2s_4 + s_4s_2 + s_3s_4 + s_4s_3) \\
                      &= -J \left[(-1) + (-1) + (-1) + (-1) + 1 + 1 + 1 + 1\right] = -J \times 0 \\
                    E &= 0 
                \end{align*}
            %    
            The magnetization formula is $\displaystyle M = \sum\limits_{k}^{N} s_k$. So in our example, we have 
            %    
                \begin{align*}
                    M &= s_1 + s_2 + s_3 + s_4 \\
                      &= (-1) + 1 + 1 + 1 \\
                    M &= 2
                \end{align*}
            %
            \paragraph{}The following table sums up the possible states of a two-dimensional square lattice model.
            %
                \begin{center}
                    \begin{tabular}{|*{8}{c|}}
                            \hline
                        Number of spins-up & \multicolumn{4}{c|}{Possible configurations} & Degeneracy & Energy & Magnetization \\
                            \hline
                            \hline
                        $4$ & \multicolumn{4}{c|}{$\begin{matrix}
                                   \uparrow & \uparrow \\
                                   \uparrow & \uparrow
                                \end{matrix}$} & $1$ & $-8J$ & $4$ \\
                            \hline
                        $3$ & $\begin{matrix}
                            \downarrow & \uparrow \\
                            \uparrow & \uparrow
                        \end{matrix}$ & $\begin{matrix}
                                            \uparrow & \downarrow \\
                                            \uparrow & \uparrow
                                         \end{matrix}$ & $\begin{matrix}
                                                               \uparrow & \uparrow \\
                                                               \downarrow & \uparrow
                                                           \end{matrix}$ & $\begin{matrix}
                                                                                \uparrow & \uparrow \\
                                                                                \uparrow & \downarrow
                                                                            \end{matrix}$ & $4$ & $0$ & $2$ \\
                            \hline
                        $2$ & $\begin{matrix}
                                   \uparrow & \uparrow \\
                                   \downarrow & \downarrow
                               \end{matrix}$ & $\begin{matrix}
                                                     \downarrow & \downarrow \\
                                                     \uparrow & \uparrow
                                                \end{matrix}$ & $\begin{matrix}
                                                                    \uparrow & \downarrow \\
                                                                    \uparrow & \downarrow
                                                                 \end{matrix}$ & $\begin{matrix}
                                                                     \downarrow & \uparrow \\
                                                                     \downarrow & \uparrow
                                                                \end{matrix}$ & $4$ & $0$ & $0$ \\
                            \hline
                        $2$ & \multicolumn{2}{c|}{$\begin{matrix}
                                    \uparrow & \downarrow \\
                                    \downarrow & \uparrow
                                \end{matrix}$} & \multicolumn{2}{c|}{$\begin{matrix}
                                                     \downarrow & \uparrow \\
                                                     \uparrow & \downarrow
                                                  \end{matrix}$} & $2$ & $8J$ & $0$ \\
                            \hline
                        $1$ & $\begin{matrix}
                            \downarrow & \downarrow \\
                            \downarrow & \uparrow
                        \end{matrix}$ & $\begin{matrix}
                                            \downarrow & \downarrow \\
                                            \uparrow & \downarrow
                                         \end{matrix}$ & $\begin{matrix}
                                                               \downarrow & \uparrow \\
                                                               \downarrow & \downarrow
                                                           \end{matrix}$ & $\begin{matrix}
                                                                                \uparrow & \downarrow \\
                                                                                \downarrow & \downarrow
                                                                            \end{matrix}$ & $4$ & $0$ & $-2$ \\
                            \hline
                        $0$ & \multicolumn{4}{c|}{$\begin{matrix}
                                                       \downarrow & \downarrow \\
                                                       \downarrow & \downarrow
                                                     \end{matrix}$} & $1$ & $-8J$ & $-4$ \\
                            \hline            
                    \end{tabular}
                \captionof{table}{Energy and magnetization for a $N = 2\times 2$-spin Ising model with periodic boundary conditions.}
                \end{center}
            
            The 16 configurations known, we can calculate the partition function in its analytic form. 
            %
                \begin{align*}
                    Z &= \sum\limits_{i=1}^{16}e^{-\beta E_i} \\
                    Z &= (1 \times e^{-\beta \times (-8J)}) + (4 \times e^{-\beta \times 0}) + (4 \times e^{-\beta \times 0}) + (2 \times e^{-\beta \times 8J}) + (4 \times e^{-\beta \times 0}) + (1 \times e^{-\beta \times (-8J)})        
                \end{align*}
            %    
                \begin{align*}
                    Z &= 2(e^{8J\beta} + e^{-8J\beta} + 6) \tag{4}\\
                    Z &= 4[\cosh(8J\beta) + 3] \tag{4'}
                \end{align*}
                
            Let's now compute the expectation value of the energy, defined by
            
                \begin{equation*}
                    \langle E \rangle = \sum\limits_{i=1}^{M}E_iP_i(\beta)
                \end{equation*}            
            
            From (2), we can write :
            
                \begin{align*}
                    \langle E \rangle &= \frac{1}{Z}\sum\limits_{i=1}^{M} E_i e^{-\beta E_i} \\
                    \langle E \rangle &= \frac{1}{Z} \left(2 \times (-8J) e^{8J\beta} + 2 \times 8J e^{-8J\beta}\right)
                \end{align*}             
            
                \begin{align*}
                    \langle E \rangle &= - \frac{J}{Z}\left( 16 e^{8J\beta} - 16 e^{-8J\beta} \right) \tag{5} \\
                    \langle E \rangle &= -8J \frac{e^{8J\beta} - e^{-8J\beta}}{e^{8J\beta} + e^{-8J\beta} + 6}
                \end{align*}
                
            So
            
                \begin{align*}
                    \langle E \rangle &= -8J \frac{\sinh (8J\beta)}{\cosh (8J\beta) + 3}  \tag{5'}
                \end{align*}
            
            Similarly, we compute the mean value of the magnetic moment (or mean magnetization) in its absolute value $\langle |M| \rangle$ :
            
                \begin{equation*}
                    \langle |M| \rangle = \sum\limits_{i=1}^{M}|M_i|P_i(\beta) = \frac{1}{Z}\sum\limits_{i=1}^{M}|M_i| e^{-\beta E_i}
                \end{equation*}
                
                \begin{equation*}
                    \langle |M| \rangle = \frac{1}{Z} \left(4 e^{8J\beta} + 4 \times 2 e^{0} + 4 \times 2 e^{0} + 4 e^{8J\beta}\right) 
                \end{equation*}
                
                \begin{align*}
                    \langle |M| \rangle &= \frac{8e^{8J\beta}+16}{Z} \tag{6} \\
                    \langle |M| \rangle &= \frac{4e^{8J\beta}+8}{e^{8J\beta}+e^{-8J\beta}+6}
                \end{align*}
            %
            which match with the fact that we have taken the external magnetic field $B=0$.
            
            We can use the expression of the expectation value of the energy to find the specific heat $C_V$ which is defined by
            %
                \begin{equation*}
                    C_V = \frac{\langle E^2 \rangle - \langle E \rangle ^2}{kT^2}
                \end{equation*}
                
            The specific heat capacity represents the amount of energy requiered to raise the temperature of a unit of mass by a unit of temperature. 
                
            We need to compute $\langle E^2 \rangle$ :
                
                \begin{align*}
                    \langle E^2 \rangle &= \sum\limits_{i=1}^{M}E_i^2P_i(\beta) =\frac{1}{Z}\sum\limits_{i=1}^{M}E_i^2 e^{-\beta E_i} \\
                    &= \frac{1}{Z}\left(2 \times (-8J)^2 e^{8J\beta} + 2 \times (8J)^2 e^{-8J\beta} \right)
                \end{align*}
                
                \begin{align*}
                    \langle E^2 \rangle &= \frac{J^2}{Z}\left(128e^{8J\beta} + 128e^{-8J\beta}\right) \tag{7} \\
                    \langle E^2 \rangle &= 64J^2 \frac{e^{8J\beta} + e^{-8J\beta}}{e^{8J\beta} + e^{-8J\beta} + 6}
                \end{align*}
                
                \begin{align*}
                    \langle E^2 \rangle &= 64J^2 \frac{\cosh(8J\beta)}{\cosh(8J\beta) +3} \tag{7'}
                \end{align*}
            
            Then, with (5), we have
            
                \begin{equation*}
                    C_V = \frac{J^2}{ZkT^2}\left[\left[128\left(e^{8J\beta} + e^{-8J\beta}\right)\right] - \frac{1}{Z}\left[16\left(e^{8J\beta}-e^{-8J\beta}\right)\right]^2\right]   
                \end{equation*}
                
                \begin{equation*}
                    C_V = \frac{256J^2}{ZkT^2}\left[\cosh(8J\beta) - \frac{4}{Z}\sinh^2(8J\beta)\right]
                    \tag{8}
                \end{equation*}
                
            Similarly, to have the susceptibility $\chi$, which is its capacity to be attracted or not into a magnetic field, defined by
            
                \begin{equation*}
                    \chi = \frac{\langle |M|^2 \rangle - \langle |M| \rangle ^2}{kT},
                \end{equation*}
            %
            we start by computing $\langle |M|^2 \rangle$ :
            
                \begin{align*}
                    \langle |M|^2 \rangle &= \sum\limits_{i=1}^{M} |M_i|^2P_i(\beta) = \frac{1}{Z}\sum\limits_{i=1}^{M}|M_i|^2 e^{-\beta E_i} \\
                    &= \frac{1}{Z}\left(4^2e^{8J\beta} + 4 \times 2^2 e^{0} + 4 \times 2^2 e^{0} + 4^2e^{8J\beta}\right) 
                \end{align*}
                
                \begin{align*}
                    \langle |M|^2 \rangle &= \frac{1}{Z}\left( 32e^{8J\beta} + 32 \right) \tag{9}\\
                    \langle |M|^2 \rangle &= 16 \frac{e^{8J\beta}+1}{e^{8J\beta} + e^{-8J\beta} + 6}
                \end{align*}
                
            Using (6), we can write
            
                \begin{align*}
                    \chi &= \frac{1}{ZkT}\left[\left(32e^{8J\beta}+32\right)-\left(\frac{(8e^{8J\beta}+16)^2}{Z}\right)\right] \tag{10}\\
                    \chi &= \frac{16}{kT}\left[\frac{3e^{8J\beta}+e^{-8J\beta}+3}{(e^{8J\beta}+e^{-8J\beta}+6)^2}\right] \\
                \end{align*}            
            

    \section{Phase transition}
    
        \subsection{The critical temperature}
        
            \paragraph{}To study the phase transitions, we consider a critical temperature. Near this temperature, a power-law applies to many physical quantities : one quantity varies as the power of another. In the Ising model, we can express the mean magnetization as 
                
                \begin{equation*}
                    \langle M(T)\rangle \sim (T-T_C)^{\beta}
                \end{equation*}
            %
            with $\beta = \frac{1}{8}$ one of the Ising critical exponents (in two dimensions).\\
            We have similar expression for the heat capacity and the susceptibility : 
            
                \begin{equation*}
                    C_V(T) \sim |T_C - T | ^{-\alpha}
                \end{equation*}
                
                \begin{equation*}
                    \chi(T) \sim |T_C - T |^{-\gamma}
                \end{equation*}
            %
            with $\alpha = 0$ and $\gamma=\frac{7}{4}$ two other critical exponents.\\
            We also defined the correlation length which is a quantity which represents how two spins are correlated. When the temperature $T$ gets closer to $T_C$, the correlation length between two spins increases. This quantity is given by 
            
                \begin{equation*}
                    \xi (T) \sim |T_C - T |^{-\nu},
                \end{equation*}
            %
            defining the constant $\nu$.
            
        \subsection{Around the critical temperature}            
            
            \paragraph{}When the correlation length spans the whole system, we say that we have a second-order (or continuous) phase transition. $\xi$ is proportional to the size of the lattice $L$ at the critical point ($\xi \propto L$), as it is always finite. With the finite size scaling relations, we can relate the temperature for a finite lattice and the one for an infinite lattice :
            
                \begin{equation*}
                    T_C(L) - T_C (L=\infty) = aL^{-\frac{1}{\nu}}
                \end{equation*}
            %
            with $a$ a constant.\\
            With the last equation, we can write :
            
                \begin{equation*}
                    \langle M(T) \rangle \sim (T-T_C)^{\beta} \rightarrow L^{-\frac{\beta}{\nu}}
                \end{equation*}
                
                \begin{equation*}
                    C_V(T) \sim |T_C -T|^{-\alpha} \rightarrow L^{\frac{\alpha}{\nu}}
                \end{equation*}
                
                \begin{equation*}
                    \chi(T) \sim |T_C - T|^{-\gamma} \rightarrow L^{\frac{\gamma}{\nu}}
                \end{equation*}
            %
            for $T$ near $T_C$.
    
    
    \section{The Metropolis algorithm}
        
        \subsection{Introduction to the algorithm}
        
            \paragraph{}The Metropolis algorithm is a Markov Chain Monte Carlo method (MCMC). We obtain a sequence of random samples from a probability distribution, here the Boltzmann distribution.\\
            Every Monte Carlo cycle is based on a Markov process to get a new random state. A Markov process is a random walk where each move has a given probability and is independent of previous moves or states of the system. The point is to run it enough time to reach the most likely state of the system, starting with a random configuration. To reach this most likely state, and so an equilibrium distribution, we need either to accept or reject the new random state. 
            
            \paragraph{}Our Monte Carlo sampling function will be the probability of finding the system in the state $i$ given in (2) :
                    
                \begin{equation*}
                    P_i = \frac{e^{-\beta E_i}}{Z}
                \end{equation*}
                
            The partition function $Z$ is hard to compute as we need to have the energies of all states $E_i$ : in two dimensions, we have $2^N$ configurations with $N=L\times L$ the number of spins. \\
            The Metropolis algorithm does not require us to compute this partition function. Indeed, we only need the difference between the energy of a configuration and the previous one.
            
        \subsection{The algorithm}
        
            \begin{center}
            \begin{algorithm}[H]
            
            \SetAlgoLined
            
                \KwIn{$E_b$ the energy of the initial random configuration.}
                \KwIn{$E_t$ the energy of the configuration obtained by flipping one spin.}
                $E_t - E_b \rightarrow \Delta E$\;
		$E_t \rightarrow E_b$\;
		$\textbf{Compute}$ expectation values for the state with the energy $E_b$\;
		
                    \For{\textnormal{each new configuration}}
                    {
                        energy of the new configuration $\rightarrow E_t$\;
		        $E_t - E_b \rightarrow \Delta E$\;
                        \eIf{$\Delta E \leq 0$}
                        {
                            $E_t \rightarrow E_b$\;
                        }{
                            $e^{-\beta \Delta E} \rightarrow w$\;
		            $\textbf{pick}$ a random number $r \in [0,1]$\;
                            \eIf{$r \leq w$}
                            {
                                The new configuration is accepted, $E_t \rightarrow E_b$\;
                            }{
                                Keep the old configuration.\;
                            }
                        }
                        $\textbf{update}$ expectation values.\;
                    } 
                  
            \caption{Monte Carlo method using the Metropolis algorithm}  
            \end{algorithm}
            \end{center}
            
            \paragraph{}In this algorithm, we go through the lattice to calculate the energy of the actual configuration of the system. This is a Monte Carlo cycle. The choice of accepting or not a configuration is made by comparing the actual energy of the system with the energy of the previous one. If the energy of the actual configuration is lower than the previous one, we accept the configuration as we try to have the lowest energy at a given temperature.
            
            \paragraph{}The strength of this method is that we do not have to compute the total energy of each configuration but only the difference between the actual configuration and the previous one. Then we do not have to compute the exponential $e^{-\beta \Delta E}$ each time we go through the loop but we can pre-calculate its possible values. When we flip the spins only one by one we are able to know all the $\Delta E$ which are possibles. For the Ising model in two dimensions, we have a total of five possible values of $\Delta E$. We take a random spin in the lattice, surrounded by four other spins, which will be flipped. The direction of the four surronding spins determines the energy of the mini-system composed of the five spins. We only need to know how the energy is modified by the flip of the spin chosen to compute $\Delta E$.\\
            In the following array, we sum up all the different possible values of $\Delta E$ according to the number of spins-up around the chosen spin.
            
                \begin{center}
                    \begin{tabular}{|c|c|c|c|c|}
                        \hline
                        Number of surr. & Energy of the  & Flipped & Energy of the & Difference of energy $\Delta E$ \\
                        spins-up & initial state & configurations & resulting state & between the two states\\
                        \hline \hline
                        4 : $\begin{array}{ccc}
                                  & \uparrow & \\
                                 \uparrow & \uparrow & \uparrow \\
                                  & \uparrow & 
                              \end{array}$ & $E_b=-4J$ & $\begin{array}{ccc}
                                                             & \uparrow & \\
                                                             \uparrow & \downarrow & \uparrow \\
                                                             & \uparrow & 
                                                          \end{array}$ & $E_t=4J$ & $\Delta E = 8J$ \\
                        \hline
                        3 : $\begin{array}{ccc}
                                  & \uparrow & \\
                                 \downarrow & \uparrow & \uparrow \\
                                  & \uparrow & 
                              \end{array}$ & $E_b=-2J$ & $\begin{array}{ccc}
                                                             & \uparrow & \\
                                                             \downarrow & \downarrow & \uparrow \\
                                                             & \uparrow & 
                                                          \end{array}$ & $E_t=2J$ & $\Delta E = 4J$ \\
                        \hline
                        2 : $\begin{array}{ccc}
                                  & \downarrow & \\
                                 \downarrow & \uparrow & \uparrow \\
                                  & \uparrow & 
                              \end{array}$ & $E_b=0$ & $\begin{array}{ccc}
                                                             & \downarrow & \\
                                                             \downarrow & \downarrow & \uparrow \\
                                                             & \uparrow & 
                                                          \end{array}$ & $E_t=0$ & $\Delta E = 0$ \\
                        \hline
                        1 : $\begin{array}{ccc}
                                  & \downarrow & \\
                                 \downarrow & \uparrow & \uparrow \\
                                  & \downarrow & 
                              \end{array}$ & $E_b=2J$ & $\begin{array}{ccc}
                                                             & \downarrow & \\
                                                             \downarrow & \downarrow & \uparrow \\
                                                             & \downarrow & 
                                                          \end{array}$ & $E_t=-2J$ & $\Delta E = -4J$ \\
                        \hline
                        0 : $\begin{array}{ccc}
                                  & \downarrow & \\
                                 \downarrow & \uparrow & \downarrow \\
                                  & \downarrow & 
                              \end{array}$ & $E_b=4J$ & $\begin{array}{ccc}
                                                             & \downarrow & \\
                                                             \downarrow & \downarrow & \downarrow \\
                                                             & \downarrow & 
                                                          \end{array}$ & $E_t=-4J$ & $\Delta E = -8J$ \\
                        \hline
                    \end{tabular}
                \captionof{table}{Possible values of $\Delta E$ for a two-dimensional Ising model}
                \end{center}


\chapter{Implementation}

    \section{The Ising model}
    
        \subsection{}
        
    \section{The Metropolis algorithm}
    
    \section{Critical temperature}



\chapter{Results}

    \section{Two-dimensional squared lattice}
    
        \subsection{$2\times2$ case}
        
            \paragraph{}This very simple case allows us to test the algorithm. We just have to compare the numerical results with the theorical ones.
            
        \subsection{$20\times20$ case}
        
            \subsubsection{The most likely state}
            
            \subsubsection{The probability distribution of a given energy}
    
    \section{Phase transitions}
    
        \subsection{The Ising model near the critical temperature}
        
        \subsection{The critical temperature}



\chapter*{Conclusion}
\addcontentsline{toc}{chapter}{Conclusion}

    \paragraph{}
    

\chapter*{Bibliography}
    
    \begin{itemize}
        \item
    \end{itemize}
    

\end{document}